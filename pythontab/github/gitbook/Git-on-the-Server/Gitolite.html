
<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<!-- Mirrored from docs.pythontab.com/github/gitbook/Git-on-the-Server/Gitolite.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 04 Oct 2022 03:55:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Gitolite &mdash; Git中文手册 0.1 文档</title>
  
  
  
    
  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  
  
   
  <script src="../_static/js/modernizr.min.js"></script>
</head>
<body class="wy-body-for-nav" role="document">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index-2.html" class="icon icon-home"> Git中文手册
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://docs.pythontab.com/github/gitbook/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Getting-Started/index.html">起步</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Git-Basics/index.html">Git 基础</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Git-Branching/index.html">Git 分支</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">服务器上的 Git</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="The-Protocols.html">协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="Getting-Git-on-a-Server.html">在服务器上部署 Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="Generating-Your-SSH-Public-Key.html">生成 SSH 公钥</a></li>
<li class="toctree-l2"><a class="reference internal" href="Setting-Up-the-Server.html">架设服务器</a></li>
<li class="toctree-l2"><a class="reference internal" href="Public-Access.html">公共访问</a></li>
<li class="toctree-l2"><a class="reference internal" href="GitWeb.html">GitWeb</a></li>
<li class="toctree-l2"><a class="reference internal" href="Gitosis.html">Gitosis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Gitolite</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">自定义安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">配置文件和存取控制规则</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deny">带&#8221;deny&#8221;规则高级访问控制</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restricting-pushes-by-files-changed">Restricting pushes by files changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">个人分支</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wildcard">&#8220;Wildcard（通配符）&#8221;库</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">其他功能</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Git-Daemon.html">Git 守护进程</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hosted-Git.html">Git 托管服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="Summary.html">小结</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Distributed-Git/index.html">分布式 Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Git-Tools/index.html">Git 工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Customizing-Git/index.html">自定义 Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Git-and-Other-Systems/index.html">Git 与其他系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Git-Internals/index.html">Git 内部原理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/index.html">命令索引</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index-2.html">Git中文手册</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index-2.html"> &mdash; Git中文手册 0.1 文档</a> &raquo;</li>
      
          <li><a href="index.html">服务器上的 Git</a> &raquo;</li>
      
    <li>Gitolite</li>
      <li class="wy-breadcrumbs-aside">
        
            <a href="../../../index.html" class="fa fa-github"> 在线手册中心</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gitolite">
<h1>Gitolite<a class="headerlink" href="#gitolite" title="永久链接至标题">¶</a></h1>
<p>Note: the latest copy of this section of the ProGit book is always available within the gitolite documentation. The author would also like to humbly state that, while this section is accurate, and can (and often has) been used to install gitolite without reading any other documentation, it is of necessity not complete, and cannot completely replace the enormous amount of documentation that gitolite comes with.</p>
<p>Git has started to become very popular in corporate environments, which tend to have some additional requirements in terms of access control. Gitolite was originally created to help with those requirements, but it turns out that it&#8217;s equally useful in the open source world: the Fedora Project controls access to their package management repositories (over 10,000 of them!) using gitolite, and this is probably the largest gitolite installation anywhere too.</p>
<p>Gitolite allows you to specify permissions not just by repository, but also by branch or tag names within each repository. That is, you can specify that certain people (or groups of people) can only push certain &#8220;refs&#8221; (branches or tags) but not others.</p>
<div class="section" id="id1">
<h2>安装<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<p>Installing Gitolite is very easy, even if you don&#8217;t read the extensive documentation that comes with it. You need an account on a Unix server of some kind; various Linux flavours, and Solaris 10, have been tested. You do not need root access, assuming git, perl, and an openssh compatible ssh server are already installed. In the examples below, we will use the gitolite account on a host called gitserver.</p>
<p>Gitolite is somewhat unusual as far as &#8220;server&#8221; software goes &#8211; access is via ssh, and so every userid on the server is a potential &#8220;gitolite host&#8221;. As a result, there is a notion of &#8220;installing&#8221; the software itself, and then &#8220;setting up&#8221; a user as a &#8220;gitolite host&#8221;.</p>
<p>Gitolite has 4 methods of installation. People using Fedora or Debian systems can obtain an RPM or a DEB and install that. People with root access can install it manually. In these two methods, any user on the system can then become a &#8220;gitolite host&#8221;.</p>
<p>People without root access can install it within their own userids. And finally, gitolite can be installed by running a script on the workstation, from a bash shell. (Even the bash that comes with msysgit will do, in case you&#8217;re wondering.)</p>
<p>We will describe this last method in this article; for the other methods please see the documentation.</p>
<p>You start by obtaining public key based access to your server, so that you can log in from your workstation to the server without getting a password prompt. The following method works on Linux; for other workstation OSs you may have to do this manually. We assume you already had a key pair generated using ssh-keygen:</p>
<div class="highlight-python"><div class="highlight"><pre>$ ssh-copy-id -i ~/.ssh/id_rsa gitolite@gitserver
</pre></div>
</div>
<p>This will ask you for the password to the gitolite account, and then set up public key access. This is essential for the install script, so check to make sure you can run a command without getting a password prompt:</p>
<div class="highlight-python"><div class="highlight"><pre>$ ssh gitolite@gitserver pwd
/home/gitolite
</pre></div>
</div>
<p>Next, you clone Gitolite from the project&#8217;s main site and run the &#8220;easy install&#8221; script (the third argument is your name as you would like it to appear in the resulting gitolite-admin repository):</p>
<div class="highlight-python"><div class="highlight"><pre>$ git clone git://github.com/sitaramc/gitolite
$ cd gitolite/src
$ ./gl-easy-install -q gitolite gitserver sitaram
</pre></div>
</div>
<p>And you&#8217;re done! Gitolite has now been installed on the server, and you now have a brand new repository called gitolite-admin in the home directory of your workstation. You administer your gitolite setup by making changes to this repository and pushing.</p>
<p>That last command does produce a fair amount of output, which might be interesting to read. Also, the first time you run this, a new keypair is created; you will have to choose a passphrase or hit enter for none. Why a second keypair is needed, and how it is used, is explained in the &#8220;ssh troubleshooting&#8221; document that comes with Gitolite. (Hey the documentation has to be good for something!)</p>
<p>Repos named gitolite-admin and testing are created on the server by default. If you wish to clone either of these locally (from an account that has SSH console access to the gitolite account via authorized_keys), type:</p>
<blockquote>
<div>$ git clone gitolite:gitolite-admin
$ git clone gitolite:testing</div></blockquote>
<p>To clone these same repos from any other account:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git clone gitolite@servername:gitolite-admin
$ git clone gitolite@servername:testing
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>自定义安装<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>While the default, quick, install works for most people, there are some ways to customise the install if you need to. If you omit the -q argument, you get a &#8220;verbose&#8221; mode install &#8211; detailed information on what the install is doing at each step. The verbose mode also allows you to change certain server-side parameters, such as the location of the actual repositories, by editing an &#8220;rc&#8221; file that the server uses. This &#8220;rc&#8221; file is liberally commented so you should be able to make any changes you need quite easily, save it, and continue. This file also contains various settings that you can change to enable or disable some of gitolite&#8217;s advanced features.</p>
</div>
<div class="section" id="id3">
<h2>配置文件和存取控制规则<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>Once the install is done, you switch to the gitolite-admin repository (placed in your HOME directory) and poke around to see what you got:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd ~/gitolite-admin/
$ ls
conf/  keydir/
$ find conf keydir -type f
conf/gitolite.conf
keydir/sitaram.pub
$ cat conf/gitolite.conf
#gitolite conf
# please see conf/example.conf for details on syntax and features

repo gitolite-admin
    RW+                 = sitaram

repo testing
    RW+                 = @all
</pre></div>
</div>
<p>Notice that &#8220;sitaram&#8221; (the last argument in the gl-easy-install command you gave earlier) has read-write permissions on the gitolite-admin repository as well as a public key file of the same name.</p>
<p>The config file syntax for gitolite is liberally documented in conf/example.conf, so we&#8217;ll only mention some highlights here.</p>
<p>You can group users or repos for convenience. The group names are just like macros; when defining them, it doesn&#8217;t even matter whether they are projects or users; that distinction is only made when you use the &#8220;macro&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre>@oss_repos      = linux perl rakudo git gitolite
@secret_repos   = fenestra pear

@admins         = scott     # Adams, not Chacon, sorry :)
@interns        = ashok     # get the spelling right, Scott!
@engineers      = sitaram dilbert wally alice
@staff          = @admins @engineers @interns
</pre></div>
</div>
<p>You can control permissions at the &#8220;ref&#8221; level. In the following example, interns can only push the &#8220;int&#8221; branch. Engineers can push any branch whose name starts with &#8220;eng-&#8221;, and tags that start with &#8220;rc&#8221; followed by a digit. And the admins can do anything (including rewind) to any ref:</p>
<div class="highlight-python"><div class="highlight"><pre>repo @oss_repos
    RW  int$                = @interns
    RW  eng-                = @engineers
    RW  refs/tags/rc[0-9]   = @engineers
    RW+                     = @admins
</pre></div>
</div>
<p>The expression after the RW or RW+ is a regular expression (regex) that the refname (ref) being pushed is matched against. So we call it a &#8220;refex&#8221;! Of course, a refex can be far more powerful than shown here, so don&#8217;t overdo it if you&#8217;re not comfortable with perl regexes.</p>
<p>Also, as you probably guessed, Gitolite prefixes refs/heads/ as a syntactic convenience if the refex does not begin with refs/.</p>
<p>An important feature of the config file&#8217;s syntax is that all the rules for a repository need not be in one place. You can keep all the common stuff together, like the rules for all oss_repos shown above, then add specific rules for specific cases later on, like so:</p>
<div class="highlight-python"><div class="highlight"><pre>repo gitolite
    RW+                     = sitaram
</pre></div>
</div>
<p>That rule will just get added to the ruleset for the gitolite repository.</p>
<p>At this point you might be wondering how the access control rules are actually applied, so let&#8217;s go over that briefly.</p>
<p>There are two levels of access control in gitolite. The first is at the repository level; if you have read (or write) access to any ref in the repository, then you have read (or write) access to the repository.</p>
<p>The second level, applicable only to &#8220;write&#8221; access, is by branch or tag within a repository. The username, the access being attempted (W or +), and the refname being updated are known. The access rules are checked in order of appearance in the config file, looking for a match for this combination (but remember that the refname is regex-matched, not merely string-matched). If a match is found, the push succeeds. A fallthrough results in access being denied.</p>
</div>
<div class="section" id="deny">
<h2>带&#8221;deny&#8221;规则高级访问控制<a class="headerlink" href="#deny" title="永久链接至标题">¶</a></h2>
<p>So far, we&#8217;ve only seen permissions to be one or R, RW, or RW+. However, gitolite allows another permission: -, standing for &#8220;deny&#8221;. This gives you a lot more power, at the expense of some complexity, because now fallthrough is not the only way for access to be denied, so the order of the rules now matters!</p>
<p>Let us say, in the situation above, we want engineers to be able to rewind any branch except master and integ. Here&#8217;s how to do that:</p>
<div class="highlight-python"><div class="highlight"><pre>RW  master integ    = @engineers
-   master integ    = @engineers
RW+                 = @engineers
</pre></div>
</div>
<p>Again, you simply follow the rules top down until you hit a match for your access mode, or a deny. Non-rewind push to master or integ is allowed by the first rule. A rewind push to those refs does not match the first rule, drops down to the second, and is therefore denied. Any push (rewind or non-rewind) to refs other than master or integ won&#8217;t match the first two rules anyway, and the third rule allows it.</p>
</div>
<div class="section" id="restricting-pushes-by-files-changed">
<h2>Restricting pushes by files changed<a class="headerlink" href="#restricting-pushes-by-files-changed" title="永久链接至标题">¶</a></h2>
<p>In addition to restricting what branches a user can push changes to, you can also restrict what files they are allowed to touch. For example, perhaps the Makefile (or some other program) is really not supposed to be changed by just anyone, because a lot of things depend on it or would break if the changes are not done just right. You can tell gitolite:</p>
<div class="highlight-python"><div class="highlight"><pre>repo foo
    RW                  =   @junior_devs @senior_devs

    RW  NAME/           =   @senior_devs
    -   NAME/Makefile   =   @junior_devs
    RW  NAME/           =   @junior_devs
</pre></div>
</div>
<p>This powerful feature is documented in conf/example.conf.</p>
</div>
<div class="section" id="id4">
<h2>个人分支<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p>Gitolite also has a feature called &#8220;personal branches&#8221; (or rather, &#8220;personal branch namespace&#8221;) that can be very useful in a corporate environment.</p>
<p>A lot of code exchange in the git world happens by &#8220;please pull&#8221; requests. In a corporate environment, however, unauthenticated access is a no-no, and a developer workstation cannot do authentication, so you have to push to the central server and ask someone to pull from there.</p>
<p>This would normally cause the same branch name clutter as in a centralised VCS, plus setting up permissions for this becomes a chore for the admin.</p>
<p>Gitolite lets you define a &#8220;personal&#8221; or &#8220;scratch&#8221; namespace prefix for each developer (for example, refs/personal/&lt;devname&gt;/<a href="#id5"><span class="problematic" id="id6">*</span></a>); see the &#8220;personal branches&#8221; section in doc/3-faq-tips-etc.mkd for details.</p>
</div>
<div class="section" id="wildcard">
<h2>&#8220;Wildcard（通配符）&#8221;库<a class="headerlink" href="#wildcard" title="永久链接至标题">¶</a></h2>
<p>Gitolite allows you to specify repositories with wildcards (actually perl regexes), like, for example assignments/s[0-9][0-9]/a[0-9][0-9], to pick a random example. This is a very powerful feature, which has to be enabled by setting $GL_WILDREPOS = 1; in the rc file. It allows you to assign a new permission mode (&#8220;C&#8221;) which allows users to create repositories based on such wild cards, automatically assigns ownership to the specific user who created it, allows him/her to hand out R and RW permissions to other users to collaborate, etc. This feature is documented in doc/4-wildcard-repositories.mkd.</p>
</div>
<div class="section" id="id7">
<h2>其他功能<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<p>We&#8217;ll round off this discussion with a sampling of other features, all of which, and many more, are described in great detail in the &#8220;faqs, tips, etc&#8221; and other documents.</p>
<p>Logging: Gitolite logs all successful accesses. If you were somewhat relaxed about giving people rewind permissions (RW+) and some kid blew away &#8220;master&#8221;, the log file is a life saver, in terms of easily and quickly finding the SHA that got hosed.</p>
<p>Git outside normal PATH: One extremely useful convenience feature in gitolite is support for git installed outside the normal $PATH (this is more common than you think; some corporate environments or even some hosting providers refuse to install things system-wide and you end up putting them in your own directories). Normally, you are forced to make the client-side git aware of this non-standard location of the git binaries in some way. With gitolite, just choose a verbose install and set $GIT_PATH in the &#8220;rc&#8221; files. No client-side changes are required after that :-)</p>
<p>Access rights reporting: Another convenient feature is what happens when you try and just ssh to the server. Gitolite shows you what repos you have access to, and what that access may be. Here&#8217;s an example:</p>
<div class="highlight-python"><div class="highlight"><pre>hello sitaram, the gitolite version here is v1.5.4-19-ga3397d4
the gitolite config gives you the following access:
     R     anu-wsd
     R     entrans
     R  W  git-notes
     R  W  gitolite
     R  W  gitolite-admin
     R     indic_web_input
     R     shreelipi_converter
</pre></div>
</div>
<p>Delegation: For really large installations, you can delegate responsibility for groups of repositories to various people and have them manage those pieces independently. This reduces the load on the main admin, and makes him less of a bottleneck. This feature has its own documentation file in the doc/ directory.</p>
<p>Gitweb support: Gitolite supports gitweb in several ways. You can specify which repos are visible via gitweb. You can set the &#8220;owner&#8221; and &#8220;description&#8221; for gitweb from the gitolite config file. Gitweb has a mechanism for you to implement access control based on HTTP authentication, so you can make it use the &#8220;compiled&#8221; config file that gitolite produces, which means the same access control rules (for read access) apply for gitweb and gitolite.</p>
<p>Mirroring: Gitolite can help you maintain multiple mirrors, and switch between them easily if the primary server goes down.</p>
</div>
</div>


           </div>
          </div>
	<hr/>
	<div>
		<p>扫码关注，获取更多内容</p>
		<img src="../../../statics/img/qrcode.jpg" width="100" height="100" />
	</div>
	<!-- duoshuo start -->
	<div class="ds-thread"></div>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"pytabdocs"};
		(function() {
			var ds = document.createElement('script');
			ds.type = 'text/javascript';ds.async = true;
			ds.src = '../../../statics/js/duoshuo.js';
			ds.charset = 'UTF-8';
			(document.getElementsByTagName('head')[0] 
			 || document.getElementsByTagName('body')[0]).appendChild(ds);
		})();
	</script>
	<!-- duoshuo end -->
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Git-Daemon.html" class="btn btn-neutral float-right" title="Git 守护进程" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Gitosis.html" class="btn btn-neutral" title="Gitosis" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; 版权所有 2015, nosy.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   
  <script type="text/javascript" src="../../../static/js/global.html" ></script>
  <script type="text/javascript">
        var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
        document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F141f4ed9eb11f462fa19fdd960639134' type='text/javascript'%3E%3C/script%3E"));
  </script>
</body>

<!-- Mirrored from docs.pythontab.com/github/gitbook/Git-on-the-Server/Gitolite.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 04 Oct 2022 03:55:45 GMT -->
</html>